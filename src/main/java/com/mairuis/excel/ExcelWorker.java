package com.mairuis.excel;import com.mairuis.excel.tools.utils.Workbooks;import com.mairuis.excel.work.WorkbookTask;import com.mairuis.utils.StringUtils;import org.apache.poi.ss.usermodel.Workbook;import org.apache.poi.ss.usermodel.WorkbookFactory;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.boot.CommandLineRunner;import org.springframework.context.ApplicationContext;import javax.annotation.Resource;import java.io.File;import java.util.Collections;import java.util.Map;/** * Excel工具集 * * @author Mairuis * @date 2019/12/8 */public class ExcelWorker implements CommandLineRunner {    private static Logger LOGGER = LoggerFactory.getLogger(ExcelWorker.class);    @Resource    ApplicationContext applicationContext;    public WorkbookTask getWorker(String name) {        for (WorkbookTask worker : applicationContext.getBeansOfType(WorkbookTask.class).values()) {            if (worker.getClass().getSimpleName().equals(name)) {                return worker;            }        }        return null;    }    @Override    public void run(String... args) throws Exception {        Map<String, String> config = Collections.unmodifiableMap(StringUtils.argsToMap(args));        WorkbookTask workbookTask = getWorker(config.getOrDefault("task", "PrintSheet"));        Workbook srcWorkbook = WorkbookFactory.create(new File(config.get("filePath")), null, false);        Workbook result = workbookTask.work(config, srcWorkbook);        Workbooks.writeToFile(result, config.get("outFilePath"));    }}