package com.mairuis.excel;import com.mairuis.excel.tools.utils.Workbooks;import com.mairuis.excel.work.SourceWork;import com.mairuis.excel.work.BaseClientSpiltWork;import com.mairuis.excel.work.WorkStrategy;import com.mairuis.utils.StringUtils;import org.apache.poi.ss.usermodel.Workbook;import org.apache.poi.ss.usermodel.WorkbookFactory;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.boot.CommandLineRunner;import java.io.File;import java.util.Collections;import java.util.HashMap;import java.util.Map;/** * Excel工具集 * * @author Mairuis * @date 2019/12/8 */public class ExcelWorker implements CommandLineRunner {    private static Map<String, WorkStrategy> WORK_STRATEGY_MAP = new HashMap<>();    private static Logger LOGGER = LoggerFactory.getLogger(ExcelWorker.class);    @Override    public void run(String... args) throws Exception {        Map<String, String> config = Collections.unmodifiableMap(StringUtils.argsToMap(args));        WorkStrategy workStrategy = WORK_STRATEGY_MAP.get(config.get("task"));        Workbook srcWorkbook = WorkbookFactory.create(new File(config.get("filePath")), null, true);        Workbook result = workStrategy.work(config, srcWorkbook);        Workbooks.writeToFile(result, config.get("outFilePath"));    }    static {        WORK_STRATEGY_MAP.put("splitCopy", new BaseClientSpiltWork());        WORK_STRATEGY_MAP.put("split", new SourceWork(new BaseClientSpiltWork()));    }}